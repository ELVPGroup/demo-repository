import { create } from "zustand";
import { merchantAxiosInstance } from "../utils/axios";

// 引入接口类型
import type { OrderDetailResponse, OrderDetail } from "../types/orderDetailInterface";

interface OrderDetailStore {
  order: OrderDetail | null;
  loading: boolean;
  error: string | null;

  // actions
  fetchOrderDetail: (orderId: string) => Promise<void>;
  clearOrder: () => void;
}

export const useOrderDetailStore = create<OrderDetailStore>((set) => ({
  order: null,
  loading: false,
  error: null,

  // 获取订单详情
  fetchOrderDetail: async (orderId: string) => {
    set({ loading: true, error: null });

    try {
      const res = await merchantAxiosInstance.get<OrderDetailResponse>(`/orders/${orderId}`);

      set({
        order: res.data.data,
        loading: false,
      });
    } catch (err: any) {
      set({
        loading: false,
        error: err.message || "获取订单失败",
      });
    }
  },

  // 清空订单
  clearOrder: () => set({ order: null }),
}));
